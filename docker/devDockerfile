FROM ubuntu:20.04

# Get all build files
RUN apt-get update
RUN yes | apt-get install gcc g++ python3 build-essential
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y cmake
RUN yes | apt-get install ninja-build
RUN yes | apt-get install sqlite
RUN yes | apt-get install clang
RUN yes | apt-get install -y ninja-build
RUN yes | apt-get install -y lldb

# Build RNAMake
RUN bash
RUN mkdir /RNAMake
ADD . /RNAMake
ENV RNAMAKE=/RNAMake
ENV X3DNA=$RNAMAKE/resources/x3dna/linux
WORKDIR /RNAMake/cmake/build/
ENV CXX=/usr/bin/clang++
ENV CC=/usr/bin/clang
RUN python3 ../make_project.py -target linux
RUN cmake -G Ninja
# RUN ninja
# RUN chmod +x ./*
# Prepare test dat for evaluation in Linux
RUN sed -i.bak 's/\r$//' /RNAMake/unittests/unittest_resources/base/path/test.csv
