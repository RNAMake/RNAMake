//
// Created by Erik Whiting on 04/08/23.
// This is just for debugging though, will delete when
// PR is marked as good-to-go

#include "../common.hpp"
#include <iostream>
#include <filesystem>
#include <sqlite3.h>

#include "resource_management/resource_manager.h"
#include "segment_data_structure/segment_graph.h"
#include "segment_data_structure/persistence.h"

using namespace persistence;
using namespace std;

TEST_CASE("Testing string shit") {
  SUBCASE("Investigating to_str failure") {
    String from_dr_Js_db = "/Users/josephyesselman/projects/RNAMake/rnamake/resources/motifs/helices/HELIX.IDEAL.2&HELIX.IDEAL.2&-7.6&0&9&GUA,G,5,A,,P 2.47669756656 -8.30386634537 -1.2280000378,OP2 3.65944371032 -7.45751148344 -1.52900004963,OP1 2.27304526668 -9.46292749321 -2.13300003577,O5' 1.16642312576 -7.38925938653 -1.2030000247,C5' -0.0923911143977 -8.00863705867 -0.884000012111,C4' -1.20870426451 -6.96497190564 -0.918000000948,O4' -1.01497636201 -6.05791374645 0.203999997115,C3' -1.22497697596 -6.05597674654 -2.13600000079,O3' -1.88679635722 -6.65817531945 -3.23999999417,C1' -1.39437354873 -4.73402750603 -0.173999999091,C2' -1.93934803849 -4.8191910022 -1.60299999364,O2' -3.33527777463 -5.05360979166 -1.49799997968,N1 0.199177081293 0.0974507765612 0.00199998497323,C2 -1.08166896254 -0.415933500344 -0.145000002218,N2 -2.04894222023 0.494776358668 -0.266999992546,N3 -1.3542807506 -1.71001534211 -0.178999999492,C4 -0.231053399741 -2.46767840801 -0.0390000107245,C5 1.06782414338 -2.05928872638 0.117999976287,C6 1.36240893039 -0.675200288662 0.145999973341,O6 2.45324118265 -0.115873013826 0.280999962433,N7 1.92015440606 -3.16003307684 0.220999967763,C8 1.11446314136 -4.18927483053 0.12499997582,N9 -0.213637900497 -3.85267324569 -0.0370000108986,;GUA,G,6,A,,P -1.46591819097 -6.25204903772 -4.72099999838,OP2 0.0140535415612 -6.15760504196 -4.80800001318,OP1 -2.10464067192 -7.17724069609 -5.69099999199,O5' -2.09635646397 -4.79123810346 -4.85699999207,C5' -3.52539809863 -4.65266680971 -4.75399997778,C4' -3.91583908267 -3.18278387585 -4.91399997388,O4' -3.4500559919 -2.45964410839 -3.73999997853,C3' -3.27805812308 -2.45259250871 -6.08399998025,O3' -3.98399210344 -2.6728042988 -7.2969999732,C1' -3.02444901484 -1.14951636734 -4.11799998279,C2' -3.31549311671 -1.00260367396 -5.61499997988,O2' -4.62765205882 -0.472997297798 -5.72999996676,N1 0.799559319094 2.1566309839 -3.51500002103,C2 -0.522506324995 2.37523437406 -3.87300000781,N2 -0.844888512785 3.64913771673 -4.10200000459,N3 -1.41821708592 1.41096561744 -3.99699999885,C4 -0.888850206986 0.188124372474 -3.72200000415,C5 0.394245738936 -0.131490713135 -3.35600001698,C6 1.35693699688 0.897798140553 -3.2290000266,O6 2.54496154661 0.816154544234 -2.91000003848,N7 0.523658834991 -1.50845195117 -3.16900001827,C8 -0.674201913662 -1.97281133028 -3.42500000629,N9 -1.59349257577 -1.00408707388 -3.7719999971,;GUA,G,7,A,,P -3.19801075266 -2.6105685016 -8.68199998105,OP2 -1.89080321007 -3.30217637047 -8.54099999413,OP1 -4.07286042418 -3.11183097905 -9.77099997231,O5' -2.95048116551 -1.04249417216 -8.85199998353,C5' -4.09574061504 -0.177837711077 -8.95899997208,C4' -3.63717563728 1.27229992367 -9.11799997666,O4' -3.04330405142 1.70047810441 -7.8599999826,C3' -2.54824769659 1.51262661286 -10.1489999876,O3' -3.07628518596 1.63746820724 -11.4619999823,C1' -1.94956840323 2.58180626475 -8.11799999354,C2' -1.89563112083 2.79082245535 -9.63499999408,O2' -2.70796948716 3.91857880459 -9.92299998596,N1 2.89717309165 3.44426032597 -6.81900004201,C2 1.9509157288 4.30197648737 -7.36200003254,N2 2.37554220744 5.54710393134 -7.58600003679,N3 0.714024681512 3.93860540371 -7.65700002018,C4 0.484416794882 2.63153646253 -7.35400001788,C5 1.34369336164 1.70979420401 -6.81200002647,C6 2.66957810506 2.09419198672 -6.50300003973,O6 3.57877996906 1.421464717 -6.01200004882,N7 0.710063591651 0.475604059547 -6.66300002014,C8 -0.502000558317 0.689240449926 -7.11400000801,N9 -0.720387252908 1.97817499192 -7.55500000583,;GUA,G,8,A,,P -2.1771601389 1.220737926 -12.7099999913,OP2 -1.45778126819 -0.0420463171713 -12.4029999985,OP1 -3.01215351359 1.198487427 -13.9369999829,O5' -1.12852078678 2.4230525719 -12.7790000017,C5' -1.62791916675 3.75090281214 -13.0219999968,C4' -0.465216819387 4.7432516675 -13.0530000084,O4' 0.0697492700288 4.85641216241 -11.7040000137,C3' 0.72890491842 4.33760988576 -13.8990000203,O3' 0.543808313027 4.65955437127 -15.2710000185,C1' 1.4866976057 5.02883725466 -11.7610000279,C2' 1.86567237382 5.11295095087 -13.2430000317,O2' 1.81126107264 6.48393468918 -13.6050000311,N1 5.82121403109 3.30813753211 -9.71700007125,C2 5.5508543368 4.50705647816 -10.3620000685,N2 6.58760468905 5.33936754071 -10.4710000789,N3 4.36475868526 4.82570066381 -10.8530000567,C4 3.44805362866 3.84242560806 -10.6390000475,C5 3.61141602759 2.63447456242 -10.0120000491,C6 4.88152007562 2.28785557802 -9.49300006185,O6 5.22482726612 1.2639585241 -8.89900006528,N7 2.41463148149 1.91611549473 -10.0080000372,C8 1.57339421315 2.70686315915 -10.6270000288,N9 2.12403598418 3.90102840541 -11.0450000343,;:CYT,C,1,A,,P 14.0759685082 0.794613845272 -4.86500015379,OP2 12.9892553604 -0.1617122117 -4.53300014293,OP1 14.9668574794 1.16488112862 -3.7370001627,O5' 13.4415749302 2.10642358624 -5.51900014745,C5' 14.3322625857 3.14769083939 -5.95700015636,C4' 13.5249149161 4.30644868724 -6.54600014828,O4' 12.9340499302 3.85627140749 -7.79800014238,C3' 12.3407745777 4.77409346619 -5.71700013644,O3' 12.7305000703 5.68921042501 -4.70200014034,C1' 11.6438732866 4.444884381 -7.96000012947,C2' 11.4345889079 5.39282163834 -6.77500012738,O2' 11.9252072818 6.66496888109 -7.17400013229,N1 10.640198831 3.35958322983 -8.03900011944,C2 9.36610228384 3.68120101535 -8.4900001067,O2 9.12975039133 4.85413016256 -8.80400010433,N3 8.42639692526 2.69891905954 -8.5770000973,C4 8.72377371537 1.44300821606 -8.22900010027,N4 7.78405035661 0.520726257559 -8.33400009088,C5 10.035881961 1.0824018323 -7.75700011339,C6 10.9525843205 2.07467688765 -7.68200012256,;CYT,C,2,A,,P 11.8754734222 5.77795392101 -3.36100013179,OP2 11.5068835433 4.41084328253 -2.9140001281,OP1 12.6022261995 6.60217198392 -2.36300013906,O5' 10.5632436763 6.54356028655 -3.85500011867,C5' 10.7058437647 7.87660312656 -4.37400012009,C4' 9.33767972215 8.42319270196 -4.78400010641,O4' 8.88590173079 7.68305713526 -5.95300010189,C3' 8.22173468252 8.2398579102 -3.76900009525,O3' 8.22742749212 9.26385966412 -2.78300009531,C1' 7.46995399508 7.5086323431 -5.89600008773,C2' 6.97972962959 8.25648530945 -4.65100008283,O2' 6.67333243927 9.58039344987 -5.06100007977,N1 7.17738930849 6.0575445084 -5.87300008481,C2 5.87051056488 5.65315242659 -6.11500007174,O2 5.01625080109 6.51889618763 -6.3380000632,N3 5.57690957819 4.32306428644 -6.1060000688,C4 6.53118103769 3.41835052716 -5.86200007835,N4 6.20256475244 2.13925188472 -5.86700007506,C5 7.89306307897 3.81175910946 -5.60600009197,C6 8.16066556674 5.13683944984 -5.62400009464,;CYT,C,3,A,,P 7.66252203211 8.9486901783 -1.32600008966,OP2 8.12892431547 7.60783003864 -0.892000094324,OP1 7.99518602627 10.0687900279 -0.412000092987,O5' 6.08653650043 8.90021738047 -1.5860000739,C5' 5.4371786249 10.0930226268 -2.06000006741,C4' 3.94025669049 9.8325735385 -2.23800005244,O4' 3.76953058696 8.91952227959 -3.35900005073,C3' 3.24846553322 9.13636596983 -1.07800004552,O3' 2.87019106043 10.0512525287 -0.0590000417369,C1' 2.67679493873 8.03819441924 -3.1000000398,C2' 2.06266537972 8.47001019981 -1.76500003366,O2' 1.05537892204 9.42470805684 -2.06500002359,N1 3.18721221578 6.64734748183 -3.09900004491,C2 2.26152215681 5.61406972833 -3.16200003565,O2 1.05943641036 5.89970911546 -3.21700002363,N3 2.70590853675 4.32620298628 -3.16900004009,C4 4.01498857844 4.05959569829 -3.11000005318,N4 4.40136746092 2.79671155512 -3.12400005705,C5 4.99467293503 5.11188965094 -3.04200006298,C6 4.52929165598 6.38275009375 -3.04000005833,;CYT,C,4,A,,P 2.77534257979 9.54622405138 1.44999995921,OP2 3.92960803085 8.6615702912 1.74999994767,OP1 2.61099279622 10.7121747989 2.35399996086,O5' 1.43560333983 8.6768220905 1.42499997261,C5' 0.199404492267 9.33945126067 1.10599998497,C4' -0.95229305555 8.33110570604 1.14099999649,O4' -0.789019774122 7.42015464703 0.0179999948552,C3' -0.999020941272 7.42409164686 2.35799999696,O3' -1.64020840138 8.04889931874 3.46200000337,C1' -1.21262645127 6.10902750603 0.395999999091,C2' -1.75365731263 6.2118652014 1.8260000045,O2' -3.14074185126 6.49344908872 1.72100001837,N1 -0.0623502043987 5.18837254747 0.258999987589,C2 -0.312940692824 3.8232973089 0.287999990094,O2 -1.48182603885 3.44094662609 0.425000001783,N3 0.727320259069 2.95360934804 0.157999979692,C4 1.9761840014 3.4079840276 0.0109999672032,N4 2.95544705606 2.53127776706 -0.117000042589,C5 2.26476068808 4.8190706641 -0.0210000356826,C6 1.21450813662 5.66075562622 0.10699997482,;:&A1-A8,6.36446511628 -1.92972093023 9.6803255814;-0.140614960882 -0.950142227244 0.278500001406 0.953116160087 -0.0537140675771 0.297699990469 -0.267892168816 0.307219646174 0.913100002679 ;11.645 -3.066 8.182 1.488 -3.653 11.983 ,cW-W@A2-A7,3.39425581395 -2.35909302326 6.86530232558;0.416461943799 -0.873075100709 0.253499995835 0.874661752141 0.460962419262 0.150399991253 -0.248147739278 0.159125562838 0.955600002481 ;7.472 -6.131 6.118 -1.949 -1.207 8.34 ,cW-W@A3-A6,1.09341860465 -1.29365116279 3.62437209302;0.841655693626 -0.518847526647 0.149699991583 0.519343927018 0.853655841589 0.0393999948066 -0.148313363447 0.0445555079941 0.987900001483 ;2.679 -6.662 3.322 -3.025 2.524 4.34 ,cW-W@A5-A4,0.000204855019413 -1.36570872974 -0.257906978702;1.000000015 0.0001000000015 -9.9999999e-09 -0.0001000000025 1.000000015 -9.9999999e-05 -1.99999995e-08 9.99999955e-05 1.0 ;-1.21262645127 6.10902750603 0.395999999091 -1.39437354873 -4.73402750603 -0.173999999091 ,cW-W@&3 0 &GGGG_LLLL_CCCC_RRRR CCCC_LLLL_GGGG_RRRR &99!assembled!assembled!G,(,5,A,;G,(,6,A,;G,(,7,A,;G,(,8,A,;|C,),1,A,;C,),2,A,;C,),3,A,;C,),4,A,;|!0 7@6 1@5 2@4 3@!0 3 !GGGG_LLLL_CCCC_RRRR CCCC_LLLL_GGGG_RRRR &&";
    String from_my_db = "&HELIX.IDEAL.2&&0&9&GUA,G,5,A,32,P 2.476698 -8.303866 -1.228000,OP2 3.659444 -7.457511 -1.529000,OP1 2.273045 -9.462927 -2.133000,O5' 1.166423 -7.389259 -1.203000,C5' -0.092391 -8.008637 -0.884000,C4' -1.208704 -6.964972 -0.918000,O4' -1.014976 -6.057914 0.204000,C3' -1.224977 -6.055977 -2.136000,O3' -1.886796 -6.658175 -3.240000,C1' -1.394374 -4.734028 -0.174000,C2' -1.939348 -4.819191 -1.603000,O2' -3.335278 -5.053610 -1.498000,N1 0.199177 0.097451 0.002000,C2 -1.081669 -0.415934 -0.145000,N2 -2.048942 0.494776 -0.267000,N3 -1.354281 -1.710015 -0.179000,C4 -0.231053 -2.467678 -0.039000,C5 1.067824 -2.059289 0.118000,C6 1.362409 -0.675200 0.146000,O6 2.453241 -0.115873 0.281000,N7 1.920154 -3.160033 0.221000,C8 1.114463 -4.189275 0.125000,N9 -0.213638 -3.852673 -0.037000,;GUA,G,6,A,32,P -1.465918 -6.252049 -4.721000,OP2 0.014054 -6.157605 -4.808000,OP1 -2.104641 -7.177241 -5.691000,O5' -2.096356 -4.791238 -4.857000,C5' -3.525398 -4.652667 -4.754000,C4' -3.915839 -3.182784 -4.914000,O4' -3.450056 -2.459644 -3.740000,C3' -3.278058 -2.452593 -6.084000,O3' -3.983992 -2.672804 -7.297000,C1' -3.024449 -1.149516 -4.118000,C2' -3.315493 -1.002604 -5.615000,O2' -4.627652 -0.472997 -5.730000,N1 0.799559 2.156631 -3.515000,C2 -0.522506 2.375234 -3.873000,N2 -0.844889 3.649138 -4.102000,N3 -1.418217 1.410966 -3.997000,C4 -0.888850 0.188124 -3.722000,C5 0.394246 -0.131491 -3.356000,C6 1.356937 0.897798 -3.229000,O6 2.544962 0.816155 -2.910000,N7 0.523659 -1.508452 -3.169000,C8 -0.674202 -1.972811 -3.425000,N9 -1.593493 -1.004087 -3.772000,;GUA,G,7,A,32,P -3.198011 -2.610569 -8.682000,OP2 -1.890803 -3.302176 -8.541000,OP1 -4.072860 -3.111831 -9.771000,O5' -2.950481 -1.042494 -8.852000,C5' -4.095741 -0.177838 -8.959000,C4' -3.637176 1.272300 -9.118000,O4' -3.043304 1.700478 -7.860000,C3' -2.548248 1.512627 -10.149000,O3' -3.076285 1.637468 -11.462000,C1' -1.949568 2.581806 -8.118000,C2' -1.895631 2.790822 -9.635000,O2' -2.707969 3.918579 -9.923000,N1 2.897173 3.444260 -6.819000,C2 1.950916 4.301976 -7.362000,N2 2.375542 5.547104 -7.586000,N3 0.714025 3.938605 -7.657000,C4 0.484417 2.631536 -7.354000,C5 1.343693 1.709794 -6.812000,C6 2.669578 2.094192 -6.503000,O6 3.578780 1.421465 -6.012000,N7 0.710064 0.475604 -6.663000,C8 -0.502001 0.689240 -7.114000,N9 -0.720387 1.978175 -7.555000,;GUA,G,8,A,32,P -2.177160 1.220738 -12.710000,OP2 -1.457781 -0.042046 -12.403000,OP1 -3.012154 1.198487 -13.937000,O5' -1.128521 2.423053 -12.779000,C5' -1.627919 3.750903 -13.022000,C4' -0.465217 4.743252 -13.053000,O4' 0.069749 4.856412 -11.704000,C3' 0.728905 4.337610 -13.899000,O3' 0.543808 4.659554 -15.271000,C1' 1.486698 5.028837 -11.761000,C2' 1.865672 5.112951 -13.243000,O2' 1.811261 6.483935 -13.605000,N1 5.821214 3.308138 -9.717000,C2 5.550854 4.507056 -10.362000,N2 6.587605 5.339368 -10.471000,N3 4.364759 4.825701 -10.853000,C4 3.448054 3.842426 -10.639000,C5 3.611416 2.634475 -10.012000,C6 4.881520 2.287856 -9.493000,O6 5.224827 1.263959 -8.899000,N7 2.414631 1.916115 -10.008000,C8 1.573394 2.706863 -10.627000,N9 2.124036 3.901028 -11.045000,;:CYT,C,1,A,32,P 14.075969 0.794614 -4.865000,OP2 12.989255 -0.161712 -4.533000,OP1 14.966857 1.164881 -3.737000,O5' 13.441575 2.106424 -5.519000,C5' 14.332263 3.147691 -5.957000,C4' 13.524915 4.306449 -6.546000,O4' 12.934050 3.856271 -7.798000,C3' 12.340775 4.774093 -5.717000,O3' 12.730500 5.689210 -4.702000,C1' 11.643873 4.444884 -7.960000,C2' 11.434589 5.392822 -6.775000,O2' 11.925207 6.664969 -7.174000,N1 10.640199 3.359583 -8.039000,C2 9.366102 3.681201 -8.490000,O2 9.129750 4.854130 -8.804000,N3 8.426397 2.698919 -8.577000,C4 8.723774 1.443008 -8.229000,N4 7.784050 0.520726 -8.334000,C5 10.035882 1.082402 -7.757000,C6 10.952584 2.074677 -7.682000,;CYT,C,2,A,32,P 11.875473 5.777954 -3.361000,OP2 11.506884 4.410843 -2.914000,OP1 12.602226 6.602172 -2.363000,O5' 10.563244 6.543560 -3.855000,C5' 10.705844 7.876603 -4.374000,C4' 9.337680 8.423193 -4.784000,O4' 8.885902 7.683057 -5.953000,C3' 8.221735 8.239858 -3.769000,O3' 8.227427 9.263860 -2.783000,C1' 7.469954 7.508632 -5.896000,C2' 6.979730 8.256485 -4.651000,O2' 6.673332 9.580393 -5.061000,N1 7.177389 6.057545 -5.873000,C2 5.870511 5.653152 -6.115000,O2 5.016251 6.518896 -6.338000,N3 5.576910 4.323064 -6.106000,C4 6.531181 3.418351 -5.862000,N4 6.202565 2.139252 -5.867000,C5 7.893063 3.811759 -5.606000,C6 8.160666 5.136839 -5.624000,;CYT,C,3,A,32,P 7.662522 8.948690 -1.326000,OP2 8.128924 7.607830 -0.892000,OP1 7.995186 10.068790 -0.412000,O5' 6.086537 8.900217 -1.586000,C5' 5.437179 10.093023 -2.060000,C4' 3.940257 9.832574 -2.238000,O4' 3.769531 8.919522 -3.359000,C3' 3.248466 9.136366 -1.078000,O3' 2.870191 10.051253 -0.059000,C1' 2.676795 8.038194 -3.100000,C2' 2.062665 8.470010 -1.765000,O2' 1.055379 9.424708 -2.065000,N1 3.187212 6.647347 -3.099000,C2 2.261522 5.614070 -3.162000,O2 1.059436 5.899709 -3.217000,N3 2.705909 4.326203 -3.169000,C4 4.014989 4.059596 -3.110000,N4 4.401367 2.796712 -3.124000,C5 4.994673 5.111890 -3.042000,C6 4.529292 6.382750 -3.040000,;CYT,C,4,A,32,P 2.775343 9.546224 1.450000,OP2 3.929608 8.661570 1.750000,OP1 2.610993 10.712175 2.354000,O5' 1.435603 8.676822 1.425000,C5' 0.199404 9.339451 1.106000,C4' -0.952293 8.331106 1.141000,O4' -0.789020 7.420155 0.018000,C3' -0.999021 7.424092 2.358000,O3' -1.640208 8.048899 3.462000,C1' -1.212626 6.109028 0.396000,C2' -1.753657 6.211865 1.826000,O2' -3.140742 6.493449 1.721000,N1 -0.062350 5.188373 0.259000,C2 -0.312941 3.823297 0.288000,O2 -1.481826 3.440947 0.425000,N3 0.727320 2.953609 0.158000,C4 1.976184 3.407984 0.011000,N4 2.955447 2.531278 -0.117000,C5 2.264761 4.819071 -0.021000,C6 1.214508 5.660756 0.107000,;:&A1-A8,6.363680 3.307021 -9.458326;-0.140615 -0.950142 0.278500 0.953116 -0.053714 0.297700 -0.267892 0.307220 0.913100 ;11.645000 -3.066000 8.182000 1.488000 -3.653000 11.983000 ,cW-W@A2-A7,3.393342 3.735502 -6.643302;0.416462 -0.873075 0.253500 0.874662 0.460962 0.150400 -0.248148 0.159126 0.955600 ;7.472000 -6.131000 6.118000 -1.949000 -1.207000 8.340000 ,cW-W@A3-A6,1.092824 2.669370 -3.402372;0.841656 -0.518848 0.149700 0.519344 0.853656 0.039400 -0.148313 0.044556 0.987900 ;2.679000 -6.662000 3.322000 -3.025000 2.524000 4.340000 ,cW-W@A4-A5,0.195603 0.692566 0.093046;1.000000 0.000100 -0.000000 -0.000100 1.000000 -0.000100 -0.000000 0.000100 1.000000 ;-1.212626 6.109028 0.396000 -1.394374 -4.734028 -0.174000 ,cW-W@&3 0 &End IDs: GGGG_LLLL_CCCC_RRRR CCCC_LLLL_GGGG_RRRR &99!assembled!assembled!G,(,5,A,;G,(,6,A,;G,(,7,A,;G,(,8,A,;|C,),1,A,;C,),2,A,;C,),3,A,;C,),4,A,;|!4 3@5 2@6 1@0 7@!3 0 !GGGG_LLLL_CCCC_RRRR CCCC_LLLL_GGGG_RRRR &&";

    Strings spl = ::base::string::split(from_dr_Js_db, "&");
    std::cout << "Original db SPL size: " << spl.size() << "\n";
    int index = 0;
    for (auto s : spl) {
      std::cout << "\nIndex " << index << "-->\n" << s << "\n";
      index++;
    }

    spl = ::base::string::split(from_my_db, "&");
    std::cout << "My db SPL size: " << spl.size() << "\n";
    index = 0;
    for (auto s : spl) {
      std::cout << "\nIndex " << index << "-->\n" << s << "\n";
      index++;
    }
  }
}
